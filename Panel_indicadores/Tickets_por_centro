-- SISN2 Problemas
SELECT CENTRO.name AS HOSPITAL, count(CENTRO.id) AS NUMERO

FROM TICKET
JOIN CENTRO ON TICKET.centro = CENTRO.id
JOIN QUEUE ON TICKET.queue_id = QUEUE.id
JOIN SERVICE ON TICKET.service_id = SERVICE.id
JOIN TICKET_PRIORITY ON TICKET.ticket_priority_id = TICKET_PRIORITY.id
JOIN TICKET_STATE ON TICKET.ticket_state_id = TICKET_STATE.id
JOIN TICKET_TYPE ON TICKET.type_id = TICKET_TYPE.id

WHERE

TICKET_TYPE.id = '5'
GROUP BY CENTRO.name
ORDER BY NUMERO DESC


-- SISN2 Incidencias
SELECT CENTRO.name AS HOSPITAL, count(CENTRO.id) AS NUMERO

FROM TICKET
JOIN CENTRO ON TICKET.centro = CENTRO.id
JOIN QUEUE ON TICKET.queue_id = QUEUE.id
JOIN SERVICE ON TICKET.service_id = SERVICE.id
JOIN TICKET_PRIORITY ON TICKET.ticket_priority_id = TICKET_PRIORITY.id
JOIN TICKET_STATE ON TICKET.ticket_state_id = TICKET_STATE.id
JOIN TICKET_TYPE ON TICKET.type_id = TICKET_TYPE.id

WHERE

TICKET_TYPE.id = '2'
GROUP BY CENTRO.name
ORDER BY NUMERO DESC


-- SISN2 Peticiones de Servicio
SELECT CENTRO.name AS HOSPITAL, count(CENTRO.id) AS NUMERO

FROM TICKET
JOIN CENTRO ON TICKET.centro = CENTRO.id
JOIN QUEUE ON TICKET.queue_id = QUEUE.id
JOIN SERVICE ON TICKET.service_id = SERVICE.id
JOIN TICKET_PRIORITY ON TICKET.ticket_priority_id = TICKET_PRIORITY.id
JOIN TICKET_STATE ON TICKET.ticket_state_id = TICKET_STATE.id
JOIN TICKET_TYPE ON TICKET.type_id = TICKET_TYPE.id

WHERE

TICKET_TYPE.id = '3'
GROUP BY CENTRO.name
ORDER BY NUMERO DESC


-- SISN2 Peticiones de Mejora/Cambio
SELECT CENTRO.name AS HOSPITAL, count(CENTRO.id) AS NUMERO

FROM TICKET
JOIN CENTRO ON TICKET.centro = CENTRO.id
JOIN QUEUE ON TICKET.queue_id = QUEUE.id
JOIN SERVICE ON TICKET.service_id = SERVICE.id
JOIN TICKET_PRIORITY ON TICKET.ticket_priority_id = TICKET_PRIORITY.id
JOIN TICKET_STATE ON TICKET.ticket_state_id = TICKET_STATE.id
JOIN TICKET_TYPE ON TICKET.type_id = TICKET_TYPE.id

WHERE

TICKET_TYPE.id in ('8', '10')
GROUP BY CENTRO.name
ORDER BY NUMERO DESC
